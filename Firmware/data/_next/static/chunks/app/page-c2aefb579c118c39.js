(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{4208:(e,t,s)=>{Promise.resolve().then(s.bind(s,10853))},10853:(e,t,s)=>{"use strict";s.d(t,{default:()=>S});var l=s(29159),a=s(64668),n=s(67826),i=s(7917),c=s(94784),r=s(48097),o=s(71375);function u(){let[e,t]=(0,o.useState)(""),[s,a]=(0,o.useState)("");return(0,o.useEffect)(()=>{fetch("/wifi").then(e=>e.json()).then(e=>{e.ssid&&e.password&&(t(e.ssid),a(e.password))})},[]),(0,l.jsxs)("div",{className:"flex flex-col items-center justify-center flex-wrap gap-4",children:[(0,l.jsxs)("p",{className:"px-3 text-start w-full",children:["保存WiFi可能导致设备重启，",(0,l.jsx)("span",{className:"block",children:"并丢失当前连接。"}),(0,l.jsx)("span",{className:"block",children:"如果无法连接到新的WiFi，"}),(0,l.jsx)("span",{className:"block",children:"设备将使用旧的WiFi。"})]}),(0,l.jsx)(r.r,{type:"text",label:"WIFI名称",value:e,onChange:function(e){console.log("SSID changed ",e.target.value),t(e.target.value)}}),(0,l.jsx)(r.r,{type:"text",label:"WIFI密码",value:s,onChange:function(e){a(e.target.value)}}),(0,l.jsx)(c.T,{color:"primary",variant:"ghost",className:"max-w-xs",onClick:function(){fetch("/setWiFi?ssid=".concat(encodeURIComponent(e),"&password=").concat(encodeURIComponent(s)),{method:"POST"})},children:"保存"})]})}var d=s(82065),x=s(6845),f=s(20108),m=s(91766);function h(){let[e,t]=(0,o.useState)(""),[s,a]=(0,o.useState)(""),[n,i]=(0,o.useState)(!1),[u,h]=(0,o.useState)(!1),[j,p]=(0,o.useState)(!1);return(0,o.useEffect)(()=>{h(!0),fetch("/spawn").then(e=>e.json()).then(e=>{e.latitude&&e.longitude&&(t(e.latitude),a(e.longitude),i(!0))}).finally(()=>{h(!1)})},[]),(0,l.jsxs)("div",{className:"w-full flex flex-col items-center justify-center flex-wrap gap-4",children:[(0,l.jsx)("p",{className:"px-3 text-start w-full",children:"当获取到GPS信号时，指南针将指向此位置。"}),(0,l.jsx)(r.r,{type:"number",label:"Latitude",value:e,onChange:function(e){let l=e.target.value;t(l),i(""!==l&&""!==s),p(!1)}}),(0,l.jsx)(r.r,{type:"number",label:"Longitude",value:s,onChange:function(t){let s=t.target.value;a(s),i(""!==e&&""!==s),p(!1)}}),(0,l.jsxs)(d.y,{placement:"bottom",isOpen:j,children:[(0,l.jsx)(x.T,{children:(0,l.jsx)(c.T,{color:"primary",variant:"ghost",className:"max-w-xs w-full",onClick:function(){let t=parseFloat(e),l=parseFloat(s);t&&l&&t>=-90&&t<=90&&l>=-180&&l<=180?(console.log("Save ",t,l),p(!1),h(!0),fetch("/spawn?latitude=".concat(e,"&longitude=").concat(s),{method:"POST"}).finally(()=>{h(!1)})):(console.log("Please enter both latitude and longitude"),p(!0),setTimeout(()=>{p(!1)},2e3))},isDisabled:!n,children:u?(0,l.jsx)(m.o,{size:"sm",isIndeterminate:!0,"aria-label":"Loading...",className:"max-w-md"}):"Save"})}),(0,l.jsx)(f.C,{children:(0,l.jsxs)("div",{className:"px-1 py-2",children:[(0,l.jsx)("div",{className:"text-small font-bold",children:"Value Error"}),(0,l.jsx)("div",{className:"text-tiny",children:"Latitude and Longitude must be numbers between -90 and 90, and -180 and 180 respectively."})]})})]})]})}function j(){let[e,t]=(0,o.useState)({buildDate:"",buildTime:"",buildVersion:"",gitBranch:"",gitCommit:""}),s=e=>{let t=new Date(e),s=t.getFullYear(),l=String(t.getMonth()+1).padStart(2,"0"),a=String(t.getDate()).padStart(2,"0");return"".concat(s,"年").concat(l,"月").concat(a,"日")};return(0,o.useEffect)(()=>{fetch("/info").then(e=>e.json()).then(e=>{if(e){let l=s(e.buildDate);t({...e,buildDate:l})}})},[]),(0,l.jsx)("div",{children:(0,l.jsxs)("ul",{children:[(0,l.jsxs)("li",{children:["版本: ",e.buildVersion]}),(0,l.jsxs)("li",{children:["分支: ",e.gitBranch]}),(0,l.jsxs)("li",{children:["提交: ",e.gitCommit]}),(0,l.jsxs)("li",{children:["构建时间: ",e.buildTime]}),(0,l.jsxs)("li",{children:["构建日期: ",e.buildDate]})]})})}var p=s(50690);function v(){let[e,t]=(0,o.useState)("#aabbcc"),[s,a]=(0,o.useState)("aabbcc"),[n,i]=(0,o.useState)(!0),u=function(e,t){let[s,l]=(0,o.useState)(e);return(0,o.useEffect)(()=>{let t=setTimeout(()=>{l(e)},200);return()=>{clearTimeout(t)}},[e,200]),s}(e,0);function d(e){return/^([0-9A-Fa-f]{3}|[0-9A-Fa-f]{6})$/.test(e)}return(0,o.useEffect)(()=>{console.log("Debounced:",u),fetch("/setColor?color=".concat(encodeURIComponent(u)),{method:"POST"})},[u]),(0,l.jsxs)("div",{className:"w-full flex flex-col items-center justify-center flex-wrap gap-4",children:[(0,l.jsx)(p.jI,{color:e,onChange:function(e){let s=e.replace("#","");a(s),d(s)?(t("#".concat(s)),i(!0)):i(!1)}}),(0,l.jsx)(r.r,{label:"输入颜色",labelPlacement:"outside",value:s,onChange:function(e){let s=e.target.value.replace("#","");a(s),d(s)?(t("#".concat(s)),i(!0)):i(!1)},placeholder:"请输入HEX颜色值",isInvalid:!n,startContent:(0,l.jsx)("div",{className:"pointer-events-none flex items-center",children:(0,l.jsx)("span",{className:"text-default-400 text-small",children:"#"})})}),(0,l.jsx)(c.T,{onPress:function(){n||alert("请输入合法的 HEX 颜色值，例如 aabbcc 或 abc")},disabled:!n,children:"确认颜色"})]})}var b=s(18960);let g={colors:"default",wifi:"success",spawn:"primary",info:"danger"};function w(e){let{activeTab:t,setActiveTab:s}=e;return(0,l.jsx)("div",{style:{zIndex:9999,position:"absolute",top:"91%",left:"47.3%",transform:"translateX(-50%)",width:"300px"},children:(0,l.jsxs)(a.r,{"aria-label":"Options",color:g[t],onSelectionChange:e=>s(e),children:[(0,l.jsx)(n.i,{title:(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)(b.lV_,{className:"mr-2"}),"颜色"]})},"colors"),(0,l.jsx)(n.i,{title:(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)(b.z5x,{className:"mr-2"}),"WiFi"]})},"wifi"),(0,l.jsx)(n.i,{title:(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)(b.sIY,{className:"mr-2"}),"出生点"]})},"spawn"),(0,l.jsx)(n.i,{title:(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)(b.sv1,{className:"mr-2"}),"固件信息"]})},"info")]})})}function N(e){let{activeTab:t}=e;return(0,l.jsx)("div",{className:"flex flex-col items-center justify-center h-full",children:(()=>{switch(t){case"colors":return(0,l.jsx)(v,{});case"wifi":return(0,l.jsx)(u,{});case"spawn":return(0,l.jsx)(h,{});case"info":return(0,l.jsx)(j,{});default:return null}})()})}function S(){let[e,t]=(0,o.useState)("colors");return(0,l.jsxs)("div",{className:"flex flex-col -mt-16 w-full",style:{height:"calc(100vh - 190px)"},children:[(0,l.jsx)(i.Z,{className:"w-full max-w-8xl mx-auto h-full",children:(0,l.jsx)("div",{className:"w-72 m-auto",children:(0,l.jsx)(N,{activeTab:e})})}),(0,l.jsx)(w,{activeTab:e,setActiveTab:t})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[174,923,688,452,679,358],()=>t(4208)),_N_E=e.O()}]);